import{c as A,z as o,j as e,F as d,a as m,b as u,d as x,I as S,e as j,M as b,L as F,J as M,u as _,q as f,m as w,f as y,D as C,g as k,h as v,C as E,i as l,A as N,k as D,l as I,n as z,o as L}from"./index-BZPDqDp9.js";var h=(a=>(a.Snake="snake_case",a.ScreamingSnake="SCREAMING_SNAKE_CASE",a))(h||{});const R={snake_case:/^[a-z][a-z0-9]*(_[a-z0-9]+)*$/,SCREAMING_SNAKE_CASE:/^[A-Z][A-Z0-9]*(_[A-Z0-9]+)*$/},{useContext:c,Form:V,Submit:Z,SetValue:$}=A(o.object({name:o.string().min(1).max(32).regex(R[h.Snake],"Must be snake_case").optional(),module:o.string()})),q=()=>{const{control:a,watch:s}=c(),n=s("module");return e.jsx(d,{control:a,name:"name",render:({field:r})=>e.jsxs(m,{children:[e.jsx(u,{children:"Name"}),e.jsx(x,{children:e.jsx(S,{...r,placeholder:n})}),e.jsx(j,{})]})})},G=()=>{const{control:a}=c();return e.jsx(d,{control:a,name:"module",render:({field:s})=>e.jsxs(m,{children:[e.jsx(u,{children:"Module"}),e.jsx(x,{children:e.jsx(b,{onValueChange:s.onChange,value:s.value})}),e.jsx(j,{})]})})},J=()=>{const{watch:a}=c(),s=a("name","module_name"),n=a("module","module_name");return e.jsxs(e.Fragment,{children:[e.jsx(F,{children:"Exmaple call"}),e.jsx(M,{readOnly:!0,editable:!1,value:`await ctx.modules.${(s||n).slice(0,32)}.scriptName(
	/* script args */
)`})]})};function O({module:a,onClose:s}){const{mutateAsync:n}=_();return e.jsxs(V,{onSubmit:async(r,g)=>{const p=r.name||a.name,t=await f.fetchQuery(w());if(t.config.modules[p])return g.setError("name",{message:"Module with this name already exists"});const i={...t.config};y(t,i,{...a,alias:r.name!==a.name?r.name:void 0}),await n(i),s==null||s()},defaultValues:{name:"",module:[a.registry,a.name].join(".")},children:[e.jsxs(C,{children:[e.jsx(k,{children:"Add module"}),e.jsxs(v,{children:["Choose a name (in ",e.jsx(E,{children:"snake_case"}),") under which new module will be available in your backend project."]})]}),e.jsxs(l,{gap:"4",direction:"col",children:[e.jsx($,{name:"name",value:a.name}),e.jsx(G,{}),e.jsx(N,{type:"single",collapsible:!0,children:e.jsxs(D,{value:"item-1",children:[e.jsx(I,{children:"Advanced"}),e.jsx(z,{children:e.jsxs(l,{gap:"4",direction:"col",px:"2",children:[e.jsx(q,{}),e.jsx(J,{})]})})]})})]}),e.jsx(L,{children:e.jsx(Z,{type:"submit",children:"Add"})})]})}export{O as default};
